<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NuTube</title>
  <link rel="icon" type="image/png" href="icons/icon48.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-primary: #0a0a0b;
      --bg-secondary: #121214;
      --bg-tertiary: #1a1a1d;
      --bg-hover: #252529;
      --bg-selected: #2d1f1f;
      --border-color: #2a2a2e;
      --text-primary: #e8e8e8;
      --text-secondary: #888;
      --text-muted: #555;
      --accent: #ff4444;
      --accent-dim: #992222;
      --success: #44ff88;
      --warning: #ffaa44;
      --font-mono: 'JetBrains Mono', monospace;
      --font-sans: 'Space Grotesk', sans-serif;
      --modal-overlay: rgba(0, 0, 0, 0.8);
      --preview-overlay: rgba(0, 0, 0, 0.9);
      --search-active-bg: rgba(255, 68, 68, 0.05);
      --activity-green: #4ade80;
      --activity-yellow: #facc15;
      --confirming-bg: rgba(239, 68, 68, 0.15);
      --btn-confirm-hover: #cc3333;
      --player-bg: #000;
    }

    /* Light mode - forced */
    [data-theme="light"] {
      --bg-primary: #f5f5f4;
      --bg-secondary: #eaeae9;
      --bg-tertiary: #dddcdb;
      --bg-hover: #d0cfce;
      --bg-selected: #f5e0e0;
      --border-color: #c5c5c3;
      --text-primary: #1a1a1b;
      --text-secondary: #666;
      --text-muted: #999;
      --accent: #dc2626;
      --accent-dim: #f5c6c6;
      --success: #16a34a;
      --warning: #ca8a04;
      --modal-overlay: rgba(0, 0, 0, 0.5);
      --preview-overlay: rgba(0, 0, 0, 0.6);
      --search-active-bg: rgba(220, 38, 38, 0.06);
      --activity-green: #16a34a;
      --activity-yellow: #ca8a04;
      --confirming-bg: rgba(220, 38, 38, 0.1);
      --btn-confirm-hover: #b91c1c;
      --player-bg: #000;
    }

    /* Auto mode - system preference */
    @media (prefers-color-scheme: light) {
      :root:not([data-theme]) {
        --bg-primary: #f5f5f4;
        --bg-secondary: #eaeae9;
        --bg-tertiary: #dddcdb;
        --bg-hover: #d0cfce;
        --bg-selected: #f5e0e0;
        --border-color: #c5c5c3;
        --text-primary: #1a1a1b;
        --text-secondary: #666;
        --text-muted: #999;
        --accent: #dc2626;
        --accent-dim: #f5c6c6;
        --success: #16a34a;
        --warning: #ca8a04;
        --modal-overlay: rgba(0, 0, 0, 0.5);
        --preview-overlay: rgba(0, 0, 0, 0.6);
        --search-active-bg: rgba(220, 38, 38, 0.06);
        --activity-green: #16a34a;
        --activity-yellow: #ca8a04;
        --confirming-bg: rgba(220, 38, 38, 0.1);
        --btn-confirm-hover: #b91c1c;
        --player-bg: #000;
      }
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      overflow: hidden;
      height: 100%;
    }

    /* Global focus-visible for accessibility */
    *:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    body {
      background: var(--bg-primary);
      color: var(--text-primary);
      font-family: var(--font-mono);
      font-size: 13px;
      line-height: 1.5;
      min-height: 100vh;
      overflow: hidden;
    }

    /* Layout */
    .app {
      display: grid;
      grid-template-rows: auto 1fr auto;
      height: 100vh;
      max-width: 1400px;
      margin: 0 auto;
      overflow: hidden;
    }

    /* Header */
    header {
      padding: 12px 16px 10px;
      border-bottom: 1px solid var(--border-color);
      display: grid;
      grid-template-rows: auto auto;
      gap: 8px;
      background: var(--bg-secondary);
      min-width: 0;
    }

    .header-top {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      min-width: 0;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
      min-width: 0;
    }

    .logo-icon {
      width: 32px;
      height: 32px;
      border-radius: 4px;
      object-fit: contain;
    }

    .logo-text {
      font-family: var(--font-sans);
      font-weight: 600;
      font-size: 18px;
      letter-spacing: -0.5px;
      white-space: nowrap;
    }

    /* Tab Navigation */
    .tab-strip-wrap {
      display: grid;
      grid-template-columns: 24px 1fr 24px;
      align-items: center;
      gap: 6px;
      min-width: 0;
      position: relative;
    }

    .tab-shift {
      width: 24px;
      height: 24px;
      border-radius: 999px;
      border: 1px solid var(--border-color);
      background: var(--bg-tertiary);
      color: var(--text-secondary);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      opacity: 0;
      pointer-events: none;
      transform: scale(0.9);
      transition: opacity 0.15s, transform 0.15s, color 0.15s, border-color 0.15s;
      font-size: 14px;
      line-height: 1;
    }

    .tab-shift.visible {
      opacity: 1;
      pointer-events: auto;
      transform: scale(1);
    }

    .tab-shift:hover {
      color: var(--text-primary);
      border-color: var(--accent);
    }

    .nav-tabs {
      display: flex;
      gap: 6px;
      margin-left: 0;
      min-width: 0;
      overflow-x: auto;
      overflow-y: hidden;
      scrollbar-width: none;
      -ms-overflow-style: none;
      scroll-behavior: smooth;
      scroll-snap-type: x mandatory;
      padding: 2px 0;
    }

    .nav-tabs::-webkit-scrollbar {
      display: none;
    }

    .nav-tab {
      padding: 7px 13px;
      background: transparent;
      border: 1px solid transparent;
      border-radius: 999px;
      color: var(--text-secondary);
      font-family: var(--font-mono);
      font-size: 12px;
      cursor: pointer;
      transition: transform 0.2s, opacity 0.2s, background 0.15s, border-color 0.15s, color 0.15s;
      flex: 0 0 auto;
      transform-origin: center;
      white-space: nowrap;
      scroll-snap-align: center;
      opacity: 0.85;
    }

    .nav-tab.rolodex-active {
      transform: translateY(0) scale(1);
      opacity: 1;
    }

    .nav-tab.rolodex-before {
      transform: translateX(-2px) scale(0.94) rotateY(14deg);
      opacity: 0.72;
    }

    .nav-tab.rolodex-after {
      transform: translateX(2px) scale(0.94) rotateY(-14deg);
      opacity: 0.72;
    }

    .nav-tab.rolodex-far {
      opacity: 0.56;
    }

    .nav-tab:hover {
      background: var(--bg-hover);
      color: var(--text-primary);
    }

    .nav-tab.active {
      background: var(--bg-tertiary);
      border-color: var(--border-color);
      color: var(--text-primary);
    }

    .nav-tab .tab-count {
      margin-left: 6px;
      padding: 2px 6px;
      background: var(--bg-hover);
      border-radius: 10px;
      font-size: 10px;
      color: var(--text-muted);
    }

    .nav-tab.active .tab-count {
      background: var(--accent-dim);
      color: var(--text-primary);
    }

    .stats {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      justify-content: flex-end;
      font-size: 12px;
      color: var(--text-secondary);
      min-width: 0;
    }

    .stat {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .stat-value {
      color: var(--text-primary);
      font-weight: 600;
    }

    /* Main content */
    main {
      display: grid;
      grid-template-columns: 1fr 280px;
      overflow: hidden;
    }

    /* Video list wrapper - needed for proper scroll containment */
    .video-list-wrapper {
      display: flex;
      flex-direction: column;
      min-height: 0; /* Critical: allows flex child to shrink and scroll */
      overflow: hidden;
    }

    /* Video list */
    .video-list-container {
      flex: 1;
      min-height: 0; /* Critical: allows scrolling within flex container */
      overflow-y: auto;
      padding: 8px;
    }

    .video-list {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .video-item {
      display: grid;
      grid-template-columns: 32px 120px 1fr auto;
      gap: 12px;
      align-items: center;
      padding: 8px 12px;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.1s;
      border: 1px solid transparent;
    }

    .video-item:hover {
      background: var(--bg-hover);
    }

    .video-item.selected {
      background: var(--bg-selected);
      border-color: var(--accent-dim);
    }

    .video-item.focused {
      outline: 1px solid var(--accent);
      outline-offset: -1px;
    }

    .video-index {
      color: var(--text-muted);
      font-size: 11px;
      text-align: right;
      font-variant-numeric: tabular-nums;
    }

    .video-thumbnail {
      width: 120px;
      height: 68px;
      border-radius: 4px;
      object-fit: cover;
      background: var(--bg-tertiary);
    }

    .video-info {
      min-width: 0;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .video-title {
      font-size: 13px;
      font-weight: 500;
      white-space: normal;
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow-wrap: anywhere;
      font-family: var(--font-sans);
      line-height: 1.3;
      max-height: calc(1.3em * 2);
    }

    .video-channel {
      font-size: 11px;
      color: var(--text-secondary);
      white-space: normal;
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 1;
      -webkit-box-orient: vertical;
      overflow-wrap: anywhere;
      line-height: 1.2;
    }

    .video-meta {
      display: flex;
      gap: 8px;
      align-items: center;
      color: var(--text-muted);
      font-size: 11px;
    }

    .video-duration {
      background: var(--bg-tertiary);
      padding: 2px 6px;
      border-radius: 2px;
      font-variant-numeric: tabular-nums;
    }

    /* Watch Later checkmark indicator */
    .wl-check {
      color: var(--accent);
      font-size: 14px;
      font-weight: bold;
    }

    /* Thumbnail wrapper for overlays */
    .thumbnail-wrapper {
      position: relative;
      width: 120px;
      height: 68px;
      flex-shrink: 0;
    }

    .thumbnail-wrapper .video-thumbnail {
      width: 100%;
      height: 100%;
    }

    /* Progress bar (watched indicator) */
    .video-progress {
      position: absolute;
      bottom: 0;
      left: 0;
      height: 3px;
      background: var(--accent);
      border-radius: 0 0 4px 4px;
      transition: width 0.2s;
    }

    .video-item.fully-watched .video-title,
    .video-item.fully-watched .video-channel {
      opacity: 0.6;
    }

    /* Hide watched indicator in stats bar */
    .hide-watched-indicator {
      color: var(--warning);
      font-size: 11px;
      font-weight: 600;
      display: none;
    }

    .hide-watched-indicator.active {
      display: inline;
    }

    /* Breadcrumb navigation */
    .breadcrumb {
      padding: 8px 16px;
      font-size: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .breadcrumb-root {
      color: var(--text-muted);
      cursor: pointer;
    }

    .breadcrumb-root:hover {
      color: var(--text-secondary);
    }

    .breadcrumb-separator {
      color: var(--text-muted);
    }

    .breadcrumb-current {
      color: var(--text-primary);
      font-weight: 500;
    }

    /* Playlist browser items */
    .playlist-browser-item {
      display: grid;
      grid-template-columns: 80px 1fr;
      gap: 12px;
      padding: 8px 16px;
      cursor: pointer;
      border-bottom: 1px solid var(--border-color);
      align-items: center;
    }

    .playlist-browser-item:hover {
      background: var(--bg-hover);
    }

    .playlist-browser-item.focused {
      background: var(--bg-hover);
      border-left: 3px solid var(--accent);
      padding-left: 13px;
    }

    .playlist-thumbnail {
      width: 80px;
      height: 45px;
      border-radius: 4px;
      background: var(--bg-tertiary);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .playlist-thumbnail img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .playlist-thumbnail-placeholder {
      color: var(--text-muted);
      font-size: 18px;
    }

    .playlist-info {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .playlist-info .playlist-title {
      font-size: 13px;
      color: var(--text-primary);
      font-weight: 500;
      line-height: 1.25;
      max-height: calc(1.25em * 2);
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow-wrap: anywhere;
    }

    .playlist-info .playlist-count {
      font-size: 11px;
      color: var(--text-secondary);
    }

    /* Mode indicator in footer */
    .mode-indicator {
      font-weight: 700;
      text-transform: uppercase;
      padding: 2px 6px;
      border-radius: 2px;
      margin-right: 12px;
      font-size: 10px;
      background: var(--bg-tertiary);
      color: var(--text-muted);
    }

    .mode-indicator.visual {
      background: var(--accent);
      color: white;
    }

    /* Sidebar */
    .sidebar {
      border-left: 1px solid var(--border-color);
      background: var(--bg-secondary);
      overflow-y: auto;
      padding: 16px;
      display: flex;
      flex-direction: column;
      gap: 24px;
      position: sticky;
      top: 0;
      height: calc(100vh - 120px);
    }

    .sidebar-section h3 {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--text-muted);
      margin-bottom: 12px;
      font-weight: 600;
    }

    /* Keyboard shortcuts */
    .shortcuts {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .shortcut-category {
      margin-bottom: 12px;
    }

    .shortcut-category:last-child {
      margin-bottom: 0;
    }

    .shortcut-category-title {
      font-size: 9px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--text-muted);
      margin-bottom: 6px;
      font-weight: 600;
    }

    .shortcut {
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 11px;
      margin-bottom: 4px;
    }

    .shortcut:last-child {
      margin-bottom: 0;
    }

    .key {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: 18px;
      height: 18px;
      padding: 0 4px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 2px;
      font-size: 10px;
      font-weight: 500;
      color: var(--text-primary);
    }

    .shortcut-desc {
      color: var(--text-secondary);
      margin-left: 4px;
    }

    /* Playlists */
    .playlist-list {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .playlist-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 10px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
      transition: background 0.1s;
    }

    .playlist-item:hover {
      background: var(--bg-hover);
    }

    .playlist-item.selected {
      background: var(--bg-selected);
      border: 1px solid var(--accent-dim);
    }

    .playlist-key {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 20px;
      height: 18px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 2px;
      font-size: 10px;
      color: var(--text-muted);
    }

    .playlist-name {
      flex: 1;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .playlist-count {
      color: var(--text-muted);
      font-size: 11px;
    }

    /* Footer / Status bar */
    footer {
      padding: 8px 24px;
      border-top: 1px solid var(--border-color);
      background: var(--bg-secondary);
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 11px;
      color: var(--text-secondary);
    }

    .status-message {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .status-message.error {
      color: var(--accent);
    }

    .status-message.success {
      color: var(--success);
    }

    .status-message.loading {
      color: var(--text-primary);
    }
    
    .status-message.loading::before {
      content: '';
      display: inline-block;
      width: 10px;
      height: 10px;
      border: 2px solid var(--text-muted);
      border-top-color: var(--accent);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin-right: 8px;
    }

    .selection-info {
      color: var(--text-muted);
      display: flex;
      align-items: center;
    }

    .theme-indicator {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--text-muted);
      cursor: pointer;
      padding: 2px 6px;
      border-radius: 2px;
      transition: color 0.15s;
    }

    .theme-indicator:hover {
      color: var(--text-secondary);
    }

    /* Modal */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: var(--modal-overlay);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.15s, visibility 0.15s;
    }

    .modal-overlay.visible {
      opacity: 1;
      visibility: visible;
    }

    .modal {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 20px;
      min-width: 400px;
      max-width: 500px;
      transform: scale(0.95);
      transition: transform 0.15s;
    }

    .modal-overlay.visible .modal {
      transform: scale(1);
    }

    .modal h2 {
      font-family: var(--font-sans);
      font-size: 16px;
      margin-bottom: 16px;
    }

    .modal-playlists {
      display: flex;
      flex-direction: column;
      gap: 4px;
      max-height: 400px;
      overflow-y: auto;
      padding: 6px;
      margin: -6px;
      margin-bottom: 0;
    }

    .modal-playlist {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 12px;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.1s;
    }

    .modal-playlist:hover {
      background: var(--bg-hover);
    }

    .modal-playlist.focused {
      background: var(--bg-selected);
      box-shadow: inset 0 0 0 1px var(--accent);
    }

    .modal-close {
      margin-top: 16px;
      text-align: center;
      color: var(--text-muted);
      font-size: 11px;
    }

    .modal-hint {
      margin-top: 12px;
      padding: 8px 12px;
      text-align: center;
      color: var(--text-muted);
      font-size: 11px;
      border-top: 1px solid var(--border-color);
    }

    .playlist-key.assigned {
      background: var(--accent);
      border-color: var(--accent);
      color: white;
      font-weight: 600;
    }

    /* Loading */
    .loading {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
      gap: 16px;
      color: var(--text-secondary);
    }

    .spinner {
      width: 32px;
      height: 32px;
      border: 2px solid var(--border-color);
      border-top-color: var(--accent);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Search */
    .search-container {
      padding: 0 8px 8px;
      position: relative;
    }

    .search-input {
      width: 100%;
      padding: 10px 12px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 4px;
      color: var(--text-primary);
      font-family: var(--font-mono);
      font-size: 13px;
      outline: none;
      transition: border-color 0.15s;
    }

    .search-input:focus {
      border-color: var(--accent);
    }

    .search-input::placeholder {
      color: var(--text-muted);
    }

    /* Active search indicator - shows when search has content */
    .search-container.active .search-input {
      border-color: var(--accent);
      background: var(--search-active-bg);
    }

    .search-container.active::before {
      content: 'Filtering';
      position: absolute;
      right: 16px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 10px;
      color: var(--accent);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* Empty state */
    .empty-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
      gap: 12px;
      color: var(--text-secondary);
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background: var(--bg-primary);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--border-color);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--text-muted);
    }

    /* Toast notifications */
    .toast-container {
      position: fixed;
      bottom: 60px;
      right: 24px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      z-index: 500;
    }

    .toast {
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      padding: 10px 16px;
      border-radius: 4px;
      font-size: 12px;
      animation: slideIn 0.2s ease-out;
    }

    .toast.success {
      border-color: var(--success);
      color: var(--success);
    }

    .toast.error {
      border-color: var(--accent);
      color: var(--accent);
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateX(20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    /* Custom right-click menu for mouse-driven actions */
    .context-menu {
      position: fixed;
      z-index: 1200;
      min-width: 190px;
      max-width: 260px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      box-shadow: 0 10px 22px rgba(0, 0, 0, 0.38);
      padding: 6px;
      display: none;
    }

    .context-menu.visible {
      display: block;
    }

    .context-menu-items {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .context-menu-item {
      width: 100%;
      text-align: left;
      border: 1px solid transparent;
      background: transparent;
      color: var(--text-primary);
      border-radius: 6px;
      font-family: var(--font-mono);
      font-size: 12px;
      line-height: 1.25;
      padding: 8px 10px;
      cursor: pointer;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .context-menu-item:hover:enabled,
    .context-menu-item:focus-visible:enabled {
      background: var(--bg-hover);
      border-color: var(--border-color);
      outline: none;
    }

    .context-menu-item.danger {
      color: var(--accent);
    }

    .context-menu-item:disabled {
      opacity: 0.48;
      cursor: not-allowed;
    }

    /* Channel items */
    .channel-item {
      display: grid;
      grid-template-columns: 32px 56px 1fr auto;
      gap: 12px;
      align-items: center;
      padding: 10px 12px;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.1s;
      border: 1px solid transparent;
    }

    .channel-item:hover {
      background: var(--bg-hover);
    }

    .channel-item.focused {
      outline: 1px solid var(--accent);
      outline-offset: -1px;
    }

    .channel-thumbnail {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      object-fit: cover;
      background: var(--bg-tertiary);
    }

    .channel-avatar-fallback {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: var(--bg-tertiary);
      display: none;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      font-weight: 600;
      color: var(--text-secondary);
      flex-shrink: 0;
    }

    /* Show fallback when no thumbnail exists */
    .channel-item:not(:has(.channel-thumbnail)) .channel-avatar-fallback {
      display: flex;
    }

    .channel-info {
      min-width: 0;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .channel-name {
      font-size: 14px;
      font-weight: 500;
      white-space: normal;
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow-wrap: anywhere;
      font-family: var(--font-sans);
      line-height: 1.2;
      max-height: calc(1.2em * 2);
    }

    .channel-stats {
      font-size: 11px;
      color: var(--text-secondary);
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      line-height: 1.2;
    }

    .channel-actions {
      display: flex;
      gap: 8px;
    }

    .btn-unsub {
      padding: 6px 12px;
      background: transparent;
      border: 1px solid var(--accent-dim);
      border-radius: 4px;
      color: var(--accent);
      font-size: 11px;
      cursor: pointer;
      transition: all 0.15s;
    }

    .btn-unsub:hover {
      background: var(--accent);
      color: white;
    }

    .btn-similar {
      padding: 6px 12px;
      background: transparent;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      color: var(--text-secondary);
      font-size: 11px;
      cursor: pointer;
      transition: all 0.15s;
    }

    .btn-similar:hover {
      background: var(--bg-hover);
      color: var(--text-primary);
    }

    /* Activity indicator dot */
    .activity-dot {
      display: inline-block;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      margin-right: 6px;
      flex-shrink: 0;
    }

    .activity-dot.recent {
      background: var(--activity-green);
      box-shadow: 0 0 4px var(--activity-green);
    }

    .activity-dot.week {
      background: var(--activity-yellow);
      box-shadow: 0 0 4px var(--activity-yellow);
    }

    /* Channel name with activity indicator */
    .channel-name-wrapper {
      display: flex;
      align-items: center;
    }

    /* Inline unsubscribe confirmation state */
    .channel-item.confirming {
      background: var(--confirming-bg);
      border-color: var(--accent-dim);
    }

    .channel-item.confirming .channel-stats {
      color: var(--accent);
      font-style: italic;
    }

    /* Suggestions modal */
    .suggestions-list {
      display: flex;
      flex-direction: column;
      gap: 4px;
      max-height: 400px;
      overflow-y: auto;
    }

    .suggestion-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 12px;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.1s;
    }

    .suggestion-item:hover {
      background: var(--bg-hover);
    }

    .suggestion-item.focused {
      background: var(--bg-selected);
      box-shadow: inset 0 0 0 1px var(--accent);
    }

    .suggestion-thumbnail {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
      background: var(--bg-tertiary);
    }

    .suggestion-info {
      flex: 1;
      min-width: 0;
    }

    .suggestion-name {
      font-size: 13px;
      font-weight: 500;
      white-space: normal;
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow-wrap: anywhere;
      line-height: 1.2;
    }

    .suggestion-subs {
      font-size: 11px;
      color: var(--text-secondary);
    }

    /* Confirm modal */
    .confirm-buttons {
      display: flex;
      gap: 12px;
      justify-content: flex-end;
      margin-top: 20px;
    }

    .btn-cancel {
      padding: 8px 16px;
      background: transparent;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      color: var(--text-secondary);
      cursor: pointer;
    }

    .btn-confirm {
      padding: 8px 16px;
      background: var(--accent);
      border: none;
      border-radius: 4px;
      color: white;
      cursor: pointer;
    }

    .btn-cancel:hover {
      background: var(--bg-hover);
    }

    .btn-confirm:hover {
      background: var(--btn-confirm-hover);
    }

    .btn-cancel.focused {
      background: var(--bg-hover);
      box-shadow: inset 0 0 0 1px var(--accent);
    }

    .btn-confirm.focused {
      background: var(--btn-confirm-hover);
      box-shadow: 0 0 0 2px var(--bg-primary), 0 0 0 4px var(--accent);
    }

    /* Keyboard navigation mode - disable mouse interactions */
    .keyboard-nav-active {
      cursor: none;
    }

    .keyboard-nav-active .video-item:hover,
    .keyboard-nav-active .channel-item:hover,
    .keyboard-nav-active .playlist-item:hover,
    .keyboard-nav-active .nav-tab:hover,
    .keyboard-nav-active .modal-playlist:hover,
    .keyboard-nav-active .suggestion-item:hover,
    .keyboard-nav-active .similar-channel-item:hover,
    .keyboard-nav-active .channel-video-item:hover,
    .keyboard-nav-active .btn-unsub:hover,
    .keyboard-nav-active .btn-similar:hover {
      background: transparent;
    }

    /* Keep selected/focused states visible in keyboard mode */
    .keyboard-nav-active .video-item.selected {
      background: var(--bg-selected);
    }

    .keyboard-nav-active .video-item.focused,
    .keyboard-nav-active .channel-item.focused {
      outline: 1px solid var(--accent);
    }

    .keyboard-nav-active .modal-playlist.focused,
    .keyboard-nav-active .suggestion-item.focused {
      background: var(--bg-selected);
    }

    .keyboard-nav-active .channel-video-item.focused {
      outline: 2px solid var(--accent);
    }

    /* Responsive: hide sidebar on narrow screens */
    @media (max-width: 900px) {
      main {
        grid-template-columns: 1fr;
      }

      .sidebar {
        display: none;
      }
    }

    @media (max-width: 760px) {
      header {
        padding: 8px 8px 7px;
        gap: 6px;
      }

      .logo {
        gap: 8px;
      }

      .logo-icon {
        width: 24px;
        height: 24px;
      }

      .logo-text {
        font-size: 14px;
      }

      .stats {
        gap: 8px;
        row-gap: 3px;
        font-size: 10px;
      }

      .stat {
        gap: 4px;
      }

      .tab-strip-wrap {
        grid-template-columns: 20px 1fr 20px;
      }

      .tab-shift {
        width: 20px;
        height: 20px;
        font-size: 12px;
      }

      .nav-tab {
        font-size: 11px;
        padding: 6px 10px;
      }

      .nav-tab .tab-count {
        margin-left: 4px;
        padding: 1px 5px;
      }

      .breadcrumb {
        padding: 6px 8px;
        font-size: 11px;
        gap: 6px;
      }

      .search-container {
        padding: 0 4px 6px;
      }

      .search-input {
        font-size: 12px;
        padding: 8px 10px;
      }

      .search-container.active::before {
        display: none;
      }

      .video-list-container {
        padding: 4px;
      }

      .video-item {
        grid-template-columns: 20px 84px 1fr auto;
        gap: 8px;
        padding: 6px 8px;
      }

      .video-index {
        font-size: 10px;
      }

      .thumbnail-wrapper {
        width: 84px;
        height: 48px;
      }

      .video-title {
        font-size: 12px;
      }

      .video-channel,
      .video-meta,
      .video-duration {
        font-size: 10px;
      }

      .video-duration {
        padding: 1px 4px;
      }

      .video-meta {
        gap: 4px;
        align-self: start;
        padding-top: 2px;
      }

      .playlist-browser-item {
        grid-template-columns: 64px 1fr;
        gap: 8px;
        padding: 7px 8px;
      }

      .playlist-thumbnail {
        width: 64px;
        height: 36px;
      }

      .playlist-info .playlist-title {
        font-size: 12px;
      }

      .playlist-info .playlist-count {
        font-size: 10px;
      }

      .channel-item {
        grid-template-columns: 20px 42px 1fr;
        gap: 8px;
        padding: 7px 8px;
      }

      .channel-thumbnail,
      .channel-avatar-fallback {
        width: 42px;
        height: 42px;
      }

      .channel-name {
        font-size: 12px;
      }

      footer {
        padding: 6px 8px;
        font-size: 10px;
      }

      .mode-indicator {
        margin-right: 8px;
      }
    }

    @media (max-width: 460px) {
      .logo-text {
        display: none;
      }

      .stats {
        gap: 6px;
      }

      .video-item {
        grid-template-columns: 16px 72px 1fr auto;
        gap: 6px;
        padding: 5px 6px;
      }

      .thumbnail-wrapper {
        width: 72px;
        height: 41px;
      }

      .video-title {
        -webkit-line-clamp: 2;
      }

      .selection-info {
        display: none;
      }
    }

    /* Loading indicators */
    .loading-indicator {
      display: none;
      width: 12px;
      height: 12px;
      margin-left: 6px;
      border: 2px solid var(--border-color);
      border-top-color: var(--accent);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    .loading-indicator.active {
      display: inline-block;
    }

    .load-more-indicator {
      text-align: center;
      padding: 16px;
      color: var(--text-muted);
      font-size: 12px;
      display: none;
    }

    .load-more-indicator.loading {
      display: block;
    }

    .load-more-indicator.loading::before {
      content: '';
      display: inline-block;
      width: 16px;
      height: 16px;
      margin-right: 8px;
      border: 2px solid var(--border-color);
      border-top-color: var(--accent);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      vertical-align: middle;
    }

    .load-more-indicator.error {
      display: block;
      color: var(--accent);
    }

    .load-more-indicator.exhausted {
      display: block;
      color: var(--text-muted);
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .tab-count.loading {
      animation: pulse 1s ease-in-out infinite;
    }

    /* Preview Modals */
    .preview-modal {
      background: var(--preview-overlay);
    }

    .preview-container {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      overflow: hidden;
      max-width: 90vw;
    }

    .video-preview {
      width: 80vw;
      max-width: 1280px;
    }

    .preview-header {
      padding: 16px 20px;
      border-bottom: 1px solid var(--border-color);
    }

    .preview-title {
      font-family: var(--font-sans);
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 4px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .preview-channel {
      font-size: 12px;
      color: var(--text-secondary);
    }

    .preview-player-container {
      position: relative;
      width: 100%;
      padding-top: 56.25%; /* 16:9 aspect ratio */
      background: var(--player-bg);
    }

    .preview-player-container iframe,
    .preview-player-container #preview-player {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }

    .preview-controls {
      padding: 12px 20px;
      background: var(--bg-tertiary);
      font-size: 11px;
      color: var(--text-muted);
      display: flex;
      gap: 16px;
      justify-content: center;
    }

    .preview-controls .key {
      margin-right: 4px;
    }

    /* Channel Preview */
    .channel-preview {
      width: 900px;
      max-width: 90vw;
    }

    .channel-preview-header {
      position: relative;
    }

    .channel-preview-banner {
      height: 100px;
      background: linear-gradient(135deg, var(--bg-tertiary), var(--bg-hover));
      background-size: cover;
      background-position: center;
    }

    .channel-preview-info {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 16px 20px;
      margin-top: -32px;
      position: relative;
    }

    .channel-preview-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      border: 3px solid var(--bg-secondary);
      background: var(--bg-tertiary);
      object-fit: cover;
    }

    .channel-preview-meta {
      padding-top: 20px;
    }

    .channel-preview-name {
      font-family: var(--font-sans);
      font-size: 20px;
      font-weight: 600;
    }

    .channel-preview-stats {
      font-size: 12px;
      color: var(--text-secondary);
      margin-top: 4px;
    }

    .channel-preview-videos {
      display: flex;
      gap: 12px;
      padding: 16px 20px;
      overflow-x: auto;
      scroll-behavior: smooth;
      min-height: 150px;
    }

    /* Section headers for channel preview */
    .channel-preview-section {
      padding: 0 20px;
    }

    .channel-preview-section h4 {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--text-muted);
      margin: 16px 0 8px;
      font-weight: 600;
    }

    /* Similar channels in preview */
    .channel-preview-similar {
      display: flex;
      gap: 12px;
      padding: 0 20px 16px;
      overflow-x: auto;
      scroll-behavior: smooth;
    }

    .similar-channel-item {
      flex-shrink: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      width: 100px;
      cursor: pointer;
      padding: 8px;
      border-radius: 4px;
      transition: background 0.15s;
    }

    .similar-channel-item:hover {
      background: var(--bg-hover);
    }

    .similar-channel-thumb {
      width: 64px;
      height: 64px;
      border-radius: 50%;
      object-fit: cover;
      background: var(--bg-tertiary);
    }

    .similar-channel-name {
      font-size: 11px;
      text-align: center;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 100%;
    }

    .channel-video-item {
      flex-shrink: 0;
      width: 200px;
      cursor: pointer;
      border-radius: 4px;
      transition: transform 0.15s;
    }

    .channel-video-item:hover {
      transform: scale(1.02);
    }

    .channel-video-item.focused {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    .channel-video-thumb {
      width: 200px;
      height: 112px;
      border-radius: 4px;
      object-fit: cover;
      background: var(--bg-tertiary);
    }

    .channel-video-title {
      font-size: 12px;
      margin-top: 8px;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .channel-video-duration {
      font-size: 10px;
      color: var(--text-muted);
      margin-top: 4px;
    }

    .channel-no-videos {
      padding: 32px;
      text-align: center;
      color: var(--text-muted);
      font-size: 13px;
    }

    /* Help modal section headers */
    .help-section-title {
      color: var(--text-muted);
      font-size: 11px;
      margin-bottom: 8px;
    }

    .help-section-title.with-margin-top {
      margin: 16px 0 8px;
    }

    /* Purge modal */
    .purge-modal {
      max-width: 600px;
      max-height: 70vh;
      display: flex;
      flex-direction: column;
    }

    .purge-list {
      overflow-y: auto;
      flex: 1;
      padding: 8px 0;
    }

    .purge-item {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 8px;
      padding: 6px 12px;
      font-size: 12px;
      border-bottom: 1px solid var(--border-color);
    }

    .purge-item-title {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .purge-item-channel {
      color: var(--text-secondary);
      font-size: 11px;
    }

    .purge-item-progress {
      color: var(--accent);
      font-size: 11px;
      white-space: nowrap;
    }

    .modal-actions {
      display: flex;
      gap: 8px;
      justify-content: flex-end;
      padding-top: 12px;
      border-top: 1px solid var(--border-color);
    }

    .btn {
      padding: 6px 16px;
      border-radius: 4px;
      font-size: 12px;
      font-family: var(--font-mono);
      cursor: pointer;
      border: none;
    }

    .btn-danger {
      background: var(--accent);
      color: white;
    }

    .btn-secondary {
      background: var(--bg-tertiary);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
    }
  </style>
</head>
<body tabindex="-1">
  <div class="app">
    <header>
      <div class="header-top">
        <div class="logo">
          <img class="logo-icon" src="icons/icon48.png" alt="NuTube">
          <span class="logo-text">NuTube</span>
        </div>
        <div class="stats">
          <div class="stat">
            <span id="video-count-label">Videos:</span>
            <span class="stat-value" id="video-count">-</span>
          </div>
          <div class="stat">
            <span>Selected:</span>
            <span class="stat-value" id="selected-count">0</span>
          </div>
          <div class="stat">
            <span class="hide-watched-indicator" id="hide-watched-indicator">Hiding watched</span>
          </div>
        </div>
      </div>
      <div class="tab-strip-wrap">
        <button class="tab-shift tab-shift-before" id="tab-shift-before" type="button" aria-label="Scroll tabs left">&#x2039;</button>
        <nav class="nav-tabs" id="tab-strip">
          <button class="nav-tab" data-tab="playlists" id="tab-playlists">
            Playlists<span class="tab-count" id="playlists-count">-</span>
          </button>
          <button class="nav-tab active" data-tab="watchlater" id="tab-watchlater">
            Watch Later<span class="tab-count" id="watchlater-count">-</span>
          </button>
          <button class="nav-tab" data-tab="subscriptions" id="tab-subscriptions">
            Subscriptions<span class="tab-count" id="subscriptions-count">-</span><span class="loading-indicator" id="subscriptions-loading"></span>
          </button>
          <button class="nav-tab" data-tab="channels" id="tab-channels">
            Channels<span class="tab-count" id="channels-count">-</span>
          </button>
        </nav>
        <button class="tab-shift tab-shift-after" id="tab-shift-after" type="button" aria-label="Scroll tabs right">&#x203A;</button>
      </div>
    </header>

    <main>
      <div class="video-list-wrapper">
        <div class="breadcrumb" id="breadcrumb" style="display: none;">
          <span class="breadcrumb-root">Playlists</span>
          <span class="breadcrumb-separator">&gt;</span>
          <span class="breadcrumb-current" id="breadcrumb-name"></span>
        </div>
        <div class="search-container">
          <input 
            type="text" 
            class="search-input" 
            id="search-input"
            placeholder="/ to search..."
            autocomplete="off"
          >
        </div>
        <div class="video-list-container" id="video-list-container">
          <div class="loading" id="loading">
            <div class="spinner"></div>
            <span id="loading-text">Loading...</span>
          </div>
          <div class="video-list" id="video-list"></div>
          <div class="load-more-indicator" id="load-more-indicator"></div>
        </div>
      </div>

      <aside class="sidebar">
        <div class="sidebar-section">
          <h3>Keyboard Shortcuts</h3>
          <div class="shortcuts" id="shortcuts-list"></div>
        </div>

        <div class="sidebar-section">
          <h3>Your Playlists</h3>
          <div class="playlist-list" id="playlist-list">
            <div class="loading">
              <div class="spinner"></div>
            </div>
          </div>
        </div>
      </aside>
    </main>

    <footer>
      <div style="display: flex; align-items: center;">
        <span class="mode-indicator" id="mode-indicator">NORMAL</span>
        <div class="status-message" id="status-message">Ready</div>
      </div>
      <div class="selection-info" id="selection-info">
        <span class="theme-indicator" id="theme-indicator">auto</span>
        <span style="margin: 0 8px; color: var(--text-muted);">&middot;</span>
        <span class="key">?</span> Help
      </div>
    </footer>
  </div>

  <!-- Move to Playlist Modal -->
  <div class="modal-overlay" id="modal-overlay">
    <div class="modal">
      <h2>Playlists</h2>
      <div class="modal-playlists" id="modal-playlists"></div>
      <div class="modal-close">Press <span class="key">Enter</span> to move &bull; <span class="key">Esc</span> to cancel</div>
    </div>
  </div>

  <!-- Help Modal -->
  <div class="modal-overlay" id="help-modal">
    <div class="modal" style="min-width: 500px;">
      <h2>Keyboard Shortcuts</h2>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 16px;">
        <div>
          <h4 class="help-section-title">NAVIGATION</h4>
          <div class="shortcuts">
            <div class="shortcut"><span class="key">j</span><span class="key">↓</span><span class="shortcut-desc">Move down</span></div>
            <div class="shortcut"><span class="key">k</span><span class="key">↑</span><span class="shortcut-desc">Move up</span></div>
            <div class="shortcut"><span class="key">gg</span><span class="shortcut-desc">Go to top</span></div>
            <div class="shortcut"><span class="key">G</span><span class="shortcut-desc">Go to bottom</span></div>
            <div class="shortcut"><span class="key">/</span><span class="shortcut-desc">Search</span></div>
          </div>
          <h4 class="help-section-title with-margin-top">SELECTION</h4>
          <div class="shortcuts">
            <div class="shortcut"><span class="key">Space</span><span class="shortcut-desc">Select / Toggle WL</span></div>
            <div class="shortcut"><span class="key">v</span><span class="shortcut-desc">Visual mode</span></div>
            <div class="shortcut"><span class="key">Ctrl+A</span><span class="shortcut-desc">Select all</span></div>
            <div class="shortcut"><span class="key">Esc</span><span class="shortcut-desc">Clear selection</span></div>
          </div>
        </div>
        <div>
          <h4 class="help-section-title">ACTIONS (ALL TABS)</h4>
          <div class="shortcuts">
            <div class="shortcut"><span class="key">x</span><span class="key">d</span><span class="key">Del</span><span class="shortcut-desc">Delete / Remove</span></div>
            <div class="shortcut"><span class="key">z</span><span class="shortcut-desc">Undo</span></div>
            <div class="shortcut"><span class="key">Ctrl+↑</span><span class="shortcut-desc">Move video up *</span></div>
            <div class="shortcut"><span class="key">Ctrl+↓</span><span class="shortcut-desc">Move video down *</span></div>
            <div class="shortcut"><span class="key">t</span><span class="shortcut-desc">Move to top *</span></div>
            <div class="shortcut"><span class="key">b</span><span class="shortcut-desc">Move to bottom *</span></div>
            <div class="shortcut"><span class="key">m</span><span class="shortcut-desc">Move to playlist *</span></div>
            <div class="shortcut"><span class="key">1-9</span><span class="shortcut-desc">Quick move *</span></div>
          </div>
          <h4 class="help-section-title with-margin-top">PLAYLISTS TAB</h4>
          <div class="shortcuts">
            <div class="shortcut"><span class="key">n</span><span class="shortcut-desc">New playlist ‡</span></div>
            <div class="shortcut"><span class="key">Shift+R</span><span class="shortcut-desc">Rename playlist ‡</span></div>
            <div class="shortcut"><span class="key">Shift+S</span><span class="shortcut-desc">Sort playlists ‡</span></div>
          </div>
          <h4 class="help-section-title with-margin-top">OTHER</h4>
          <div class="shortcuts">
            <div class="shortcut"><span class="key">Tab</span><span class="shortcut-desc">Switch tabs</span></div>
            <div class="shortcut"><span class="key">r</span><span class="shortcut-desc">Refresh</span></div>
            <div class="shortcut"><span class="key">w</span><span class="shortcut-desc">Add to Watch Later</span></div>
            <div class="shortcut"><span class="key">Enter</span><span class="shortcut-desc">Open in YouTube</span></div>
            <div class="shortcut"><span class="key">T</span><span class="shortcut-desc">Cycle theme</span></div>
            <div class="shortcut"><span class="key">?</span><span class="shortcut-desc">Toggle help</span></div>
          </div>
          <div style="margin-top: 12px; font-size: 11px; color: var(--text-secondary); line-height: 1.4;">
            <div>* Watch Later & Playlist videos only</div>
            <div>‡ Playlist list view only</div>
          </div>
        </div>
      </div>
      <div class="modal-close">Press <span class="key">?</span> or <span class="key">Esc</span> to close</div>
    </div>
  </div>

  <!-- Suggestions Modal -->
  <div class="modal-overlay" id="suggestions-modal">
    <div class="modal">
      <h2 id="suggestions-title">Similar Channels</h2>
      <div class="suggestions-list" id="suggestions-list"></div>
      <div class="modal-close">Press <span class="key">Enter</span> to open channel &bull; <span class="key">Esc</span> to close</div>
    </div>
  </div>

  <!-- Confirm Modal -->
  <div class="modal-overlay" id="confirm-modal">
    <div class="modal" style="min-width: 350px;">
      <h2 id="confirm-title">Confirm</h2>
      <p id="confirm-message" style="color: var(--text-secondary); margin: 16px 0;"></p>
      <div class="confirm-buttons">
        <button class="btn-cancel" id="confirm-cancel">Cancel</button>
        <button class="btn-confirm" id="confirm-ok">Unsubscribe</button>
      </div>
    </div>
  </div>

  <!-- Purge Watched Modal -->
  <div class="modal-overlay" id="purge-modal" style="display: none;">
    <div class="modal purge-modal">
      <div class="modal-header">
        <h3>Remove Watched Videos</h3>
        <span class="modal-subtitle" id="purge-count"></span>
      </div>
      <div class="purge-list" id="purge-list"></div>
      <div class="modal-actions">
        <button class="btn btn-danger" id="purge-confirm">Remove All</button>
        <button class="btn btn-secondary" id="purge-cancel">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Channel Preview Modal -->
  <div class="modal-overlay preview-modal" id="channel-preview-modal">
    <div class="preview-container channel-preview">
      <div class="channel-preview-header">
        <div class="channel-preview-banner" id="channel-preview-banner"></div>
        <div class="channel-preview-info">
          <img class="channel-preview-avatar" id="channel-preview-avatar" src="" alt="">
          <div class="channel-preview-meta">
            <div class="channel-preview-name" id="channel-preview-name"></div>
            <div class="channel-preview-stats" id="channel-preview-stats"></div>
          </div>
        </div>
      </div>
      <div class="channel-preview-section">
        <h4>Latest Videos</h4>
      </div>
      <div class="channel-preview-videos" id="channel-preview-videos"></div>
      <div class="channel-preview-section">
        <h4>Similar Channels</h4>
      </div>
      <div class="channel-preview-similar" id="channel-preview-similar"></div>
      <div class="preview-controls">
        <span class="key">h</span><span class="key">l</span> scroll
        <span class="key">0</span><span class="key">$</span> first/last
        <span class="key">↵</span> watch
        <span class="key">q</span> close
      </div>
    </div>
  </div>

  <!-- Toast Container -->
  <div class="toast-container" id="toast-container"></div>

  <!-- Context Menu -->
  <div class="context-menu" id="context-menu">
    <div class="context-menu-items" id="context-menu-items"></div>
  </div>

  <script src="dashboard.js"></script>
</body>
</html>
